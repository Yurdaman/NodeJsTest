<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <title>Fullstack Prints</title>
    <style>
      /* Basic styling for the grid */
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
      }

      .container {
        max-width: 1200px;
        margin: 20px auto;
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 20px;
      }

      .product {
        background-color: #fff;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: transform 0.2s ease-in-out;
      }

      .product:hover {
        transform: scale(1.05);
      }

      .product img {
        width: 100%;
        height: 200px;
        object-fit: cover;
      }

      .product-details {
        padding: 10px;
      }

      .product-details h3 {
        font-size: 14px;
        margin: 0;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      .product-details p {
        font-size: 12px;
        color: #666;
        margin: 5px 0 0 0;
      }

      /* Pagination buttons */
      .pagination {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 20px;
      }

      .pagination button {
        padding: 10px 20px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
      }

      .pagination button:disabled {
        background-color: #ccc;
        cursor: not-allowed;
      }
    </style>
  </head>
  <body>
    <h1>Prints</h1>
    <div class="container" id="products-container"></div>

    <!-- Pagination controls -->
    <div class="pagination">
      <button id="prev-page">Previous</button>
      <button id="next-page">Next</button>
    </div>

    <script>
      let offset = 0; // Initial offset
      const limit = 25; // Number of products per page

      // Fetch products from the API
      async function fetchProducts(offset, limit) {
        const url = `http://localhost:1337/products?limit=${limit}&offset=${offset}&tag=Bryan%20Brittos`;
        const response = await fetch(url);
        if (!response.ok) {
          throw new Error("Failed to fetch products");
        }
        const data = await response.json();
        return data;
      }

      // Render products in the container
      function renderProducts(products) {
        const container = document.getElementById("products-container");
        container.innerHTML = ""; // Clear the current list

        products.forEach((product) => {
          const card = document.createElement("div");
          card.className = "product";

          // Image
          const img = document.createElement("img");
          img.src = product.urls.regular; // Use regular-sized image
          img.alt = product.alt_description;

          // Product details
          const details = document.createElement("div");
          details.className = "product-details";

          // Description
          const description = document.createElement("h3");
          description.textContent = product.alt_description;

          // Photographer
          const photographer = document.createElement("p");
          photographer.textContent = product.user.name;

          // Append elements
          details.appendChild(description);
          details.appendChild(photographer);
          card.appendChild(img);
          card.appendChild(details);
          container.appendChild(card);
        });
      }

      // Update pagination buttons state
      function updatePaginationButtons() {
        const prevButton = document.getElementById("prev-page");
        const nextButton = document.getElementById("next-page");

        prevButton.disabled = offset <= 0; // Disable "Previous" if offset is 0
        nextButton.disabled = false; // Enable "Next" by default
      }

      // Event listener for "Next" button
      document
        .getElementById("next-page")
        .addEventListener("click", async () => {
          offset += limit;
          try {
            const products = await fetchProducts(offset, limit);
            renderProducts(products);
            updatePaginationButtons();
          } catch (error) {
            console.error("Error fetching products:", error);
          }
        });

      // Event listener for "Previous" button
      document
        .getElementById("prev-page")
        .addEventListener("click", async () => {
          if (offset >= limit) {
            offset -= limit;
            try {
              const products = await fetchProducts(offset, limit);
              renderProducts(products);
              updatePaginationButtons();
            } catch (error) {
              console.error("Error fetching products:", error);
            }
          }
        });

      // Load the first page on page load
      (async () => {
        try {
          const products = await fetchProducts(offset, limit);
          renderProducts(products);
          updatePaginationButtons();
        } catch (error) {
          console.error("Error fetching products:", error);
        }
      })();
    </script>
  </body>
</html>
